# Task 7: Vulnerability Scan Simulation

## Simulated Activity:
> Use Nmap or Nessus Essentials to scan a host.  
> **Observe** what the target logs during a port scan or vulnerability enumeration.  
> Focus: How can defenders detect scanning attempts?

---

### Setup

- **Attacker System:** Kali Linux (2024.2)
- **Target System:** Windows 10 (VirtualBox)
- **Network:** Host-Only Adapter  
- **Tools Used:**  
  - `nmap` (on Kali)
  - Sysmon + Wazuh Agent (on Windows)
  - Windows Firewall

---

## Steps to Simulate Scan
1. Verified IP Reachability
   Pinged Windows from Kali:
   ```bash
   ping 192.168.1.42
   ```
   Success: Ping reply received
2. Performed Stealth SYN Scan from Kali
   ```bash
   nmap -sS -Pn -T4 -v 192.168.1.42
   ```
3. From Kali, performed multiple Nmap scans: Service version and OS Detection
   ```bash
   nmap -sV -O <windows-ip>
   ```
4. All port scan performed
   ```bash
   nmap -p- <windows-ip>
   ```
![](https://github.com/alj-v/cyber-intern-phase-2/blob/main/screenshots/hint07_vulnerability_scan_simulated.png)

## Logs and Observations
### Observed in Local Windows Event Viewer:
### Multiple logs with Event ID 5152 (Windows Filtering Platform blocked inbound traffic):
- Source IP: 192.168.1.40 (Kali)
- Destination Ports: Varied
- These indicate connection attempts were being monitored.
![](https://github.com/alj-v/cyber-intern-phase-2/blob/main/screenshots/hint07_vulnerability_scan_windows_log_5152.png)
### One Sysmon log observed with Event ID 3 (Network connection detected):
- Source: C:\Windows\System32\svchost.exe
- Source IP: Kali's IP
- Destination IP: Windows 10 IP
- Suggests detection of back-and-forth activity during scan.
![](https://github.com/alj-v/cyber-intern-phase-2/blob/main/screenshots/hint07_vulnerability_scan_windows_security_log.png)

### âŒ Not Observed in Wazuh Dashboard:
- No 5152 logs forwarded from Windows agent.
- Only a single Sysmon Event ID 3 was captured.
- No firewall logs appeared in Wazuh.

> Note: The local logs confirmed the scan, but not all logs were pushed to Wazuh.

Troubleshooting Considerations
- Sysmon Coverage: Might need config update to catch more Event ID 3s.
- OSSEC Agent Configuration: May not be set to collect Security log channel or Microsoft-Windows-Security-Auditing events properly.
- Firewall Log File: May not be forwarded by agent unless explicitly configured in ossec.conf.
